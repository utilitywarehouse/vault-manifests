mappings:
  # vault.route.update.auth-kubernetes- -> vault_route{method="update",path="auth-kubernetes"}
  - match: vault\.route\.(.*)\.(.*)-
    match_type: regex
    timer_type: histogram
    name: "vault_route"
    labels:
      method: "$1"
      path: "$2"
  # vault.rollback.attempt.sys- -> vault_rollback_attempt{path="sys"}
  - match: vault\.rollback\.attempt\.(.*)-
    match_type: regex
    timer_type: histogram
    name: "vault_rollback_attempt"
    labels:
      path: "$1"
  # vault.barrier.delete -> vault_barrier{method="delete"}
  - match: vault.barrier.*
    name: "vault_barrier"
    timer_type: histogram
    labels:
      method: "$1"
  # vault.raft.storage.get -> vault_raft_storage{method="get"}
  - match: vault.raft.storage.*
    name: "vault_raft_storage"
    timer_type: histogram
    labels:
      method: "$1"
  # vault_raft_leader_lastContact is a summary
  # (https://prometheus.io/docs/concepts/metric_types/#summary) and has a default
  # sliding window of 10m. This is not useful when we have short, sharp spikes.
  # Changing the window to 30sec will more accurately show these spikes.
  - match: vault.raft.leader.lastContact
    name: "vault_raft_leader_lastContact"
    summary_options:
      max_summary_age: 30s
      # With only one age bucket, you will
      # effectively see a complete reset of the summary each time MaxAge has
      # passed.
      summary_age_buckets: 1
